# Бібліотека запропонованих функцій

---

Оскільки PAWN розроблено як мову розширення додатків, більшість функцій
функцій, доступних для програм PAWN, будуть специфічними для
хост-програми. Тим не менш, невеликий набір функцій може виявитися корисним
у багатьох середовищах.

### - Основні функції

"Ядро" модуля складається з набору функцій, які підтримують саму мову
саму мову. Деякі з цих функцій потрібні для витягування аргументів зі змінної
список аргументів (див. сторінку 80).

| Затиснути | | Примусити значення всередині діапазону
| -------- | ----------------------------------------------------------------------------------------------------------- | ----------------------------: |
| Синтаксис: clamp(value, min=cellmin, max=cellmax)
| значення | Значення, яке потрібно затиснути в діапазоні
| min - нижня межа діапазону. |
| max - верхня межа діапазону. |
| Повертає значення, якщо воно знаходиться у діапазоні min - max; min, якщо значення менше за min; і max, якщо значення більше за max. | |
| Дивіться також max, min

| funcidx | | Повертає індекс публічної функції
| ------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------: |
| Синтаксис: funcidx(const name[])
| Повертає індекс названої загальнодоступної функції. Якщо загальнодоступної функції з таким іменем не існує, funcidx повертає -1.                                                                                                                                             | |
| Примітки:  | Хост-додаток запускає загальнодоступну функцію зі скрипта, передаючи індекс загальнодоступної функції до amx_Exec. За допомогою цієї функції скрипт може запитувати індекс загальнодоступної функції і таким чином повертати програмі "наступну функцію для виклику". | |

| Отримати аргумент.
| -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------: |
| Синтаксис getarg(arg, index=0)
| arg | | Порядковий номер аргументу, використовуйте 0 для першого аргументу. |
| | | | index | Індекс, якщо arg посилається на масив. |
| Повертає значення аргументу.
| Примітки:   | Ця функція отримує аргумент зі змінного списку аргументів. Якщо аргумент є масивом, параметр index вказує індекс у масиві. Значенням, що повертається, є знайдений аргумент. | |
| Дивіться також numargs, setarg

| Повернути вільне місце в пам'яті.
| --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------: |
| Синтаксис: heapspace()
| Повертає вільний простір у купі. Стек і купа займають спільну область пам'яті, тому це значення вказує на кількість байт, яка залишилася для стека або купи. | |
| Примітки:    | За відсутності рекурсії синтаксичний аналізатор пішаків також може дати оцінку необхідного об'єму стеку/купки.                                                                       | |

| Повернути найбільше з двох чисел.
| -------- | ------------------------------------- | ---------------------------------------------------: 
| Синтаксис max(value1, value2)
| значення1
| значення2 | Два значення, для яких потрібно знайти найбільше число. |
| Повертає найбільше значення значення1 та значення2.
| Дивіться також: clamp, min

| Повернути найменше з двох чисел.
| -------- | ------------------------------------- | --------------------------------------------------: 
| Синтаксис: min(value1, value2)
| значення1 значення2
| значення2 | | Два значення, для яких потрібно знайти найменше число. |
| Повертає найменше значення значення1 та значення2.
| Дивіться також: clamp, max

| numargs | | Повернути кількість аргументів
| -------- | -------------------------------------------------------------------------------------------------------------- | -----------------------------: |
| Синтаксис numargs()
| Повертає кількість аргументів, переданих у функцію; numargs корисний всередині функцій зі змінним списком аргументів
| Дивіться також | getarg, setarg

| Випадкове число. Повертає псевдовипадкове число.
| ------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------: |
| Синтаксис: random(max)
| max - межа для випадкового числа.
| Повертає псевдовипадкове число в діапазоні 0 - max-1
| Примітки:  | Стандартний генератор випадкових чисел пішака, ймовірно, є лінійним конгруентним генератором псевдовипадкових чисел з діапазоном і періодом 2³¹. Лінійні конгруентні генератори псевдовипадкових чисел страждають від послідовної кореляції (особливо в молодших розрядах) і не підходять для застосувань, які вимагають високоякісних випадкових чисел. | |

| Сетарг.
| -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | -----------------------------------------------------: |
| Синтаксис | setarg(arg, index=0, value)
| arg | Порядковий номер аргументу, використовуйте 0 для першого аргументу
| | | index | Індекс, якщо arg посилається на масив | | | value | Значення, яке потрібно встановити
| значення | Значення, яке потрібно встановити для аргументу
| Повертає значення true у разі успіху та false, якщо аргумент або індекс є недійсними
| Примітки:   | Ця функція встановлює значення аргументу зі списку аргументів змінної. Якщо аргумент є масивом, параметр index задає індекс у масиві. | |
| Дивіться також getarg, numargs

| Замінити байти в комірці.
| --------- | ----------------------------------------------------------------------------------------------- | ------------------------------------: |
| Синтаксис: swapchars(c)
| Значення, для якого потрібно поміняти місцями байти
| Повертає значення, де байти у параметрі "c" поміняно місцями (молодший байт стає старшим)

| tolower | | Перетворити символ у нижній регістр
| -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------: |
| Синтаксис tolower(c)
| c - символ, який потрібно перетворити в нижній регістр. |
| Повертає варіант вхідного символу у верхньому регістрі, якщо такий існує, або незмінений код символу "c", якщо літера "c" не має еквівалента у нижньому регістрі. | |
| Примітки:   | Підтримка символів з наголосом залежить від платформи.
| Див. також розпізнавання символів

| toupper | | Перетворити символ у верхній регістр
| -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------: |
| Синтаксис toupper(c)
| c - символ, який потрібно перетворити у верхній регістр. |
| Повертає варіант символу у нижньому регістрі, якщо такий існує, або незмінений код символу "c", якщо літера "c" не має еквівалента у верхньому регістрі. | |
| Примітки:   | Підтримка символів з наголосом залежить від платформи.
| Див. також нижче

---

Властивості - це імена або значення загального призначення. Список властивостей
підтримує список цих пар імен/значень, який є спільним для всіх абстрактних
машинами. Таким чином, список властивостей є способом для паралельних абстрактних машин
обмінюватися інформацією.

Всі функції "обслуговування властивостей" мають необов'язковий параметр "id". Ви
ви можете використовувати цей параметр, щоб вказати, до якої абстрактної машини належить властивість
належить властивість. (Основна програма, яка підтримує паралельні абстрактні машини, зазвичай
надає кожній абстрактній машині унікальний ідентифікатор). При запиті (або видаленні)
властивості, значення ідентифікатора, яке ви передаєте, порівнюється зі значеннями ідентифікаторів у списку
списку.

Властивість ідентифікується за допомогою її "абстрактного ідентифікатора машини" плюс ім'я або
значенням. Інтерфейс на основі імен дозволяє прикріпити значення (наприклад, дескриптор об'єкта) до імені на ваш розсуд.
об'єкта) до довільного імені. Інтерфейс на основі значення дозволяє вам
приєднати рядок до числа. Різниця між цими двома способами полягає, в основному, у
ключем пошуку та параметром виводу.

Усі функції обслуговування властивостей мають параметр "ім'я" і параметр "значення".
Тільки один з цієї пари повинен бути заповнений. Коли ви вказуєте значення, функція getprop
erty зберігає результат у рядковому аргументі, а функція setproperty
зчитує рядок для збереження з рядкового аргументу.

Кількість властивостей, які ви можете додати, обмежена лише доступною пам'яттю.

**getproperty(id=0, const name[]="", value=cellmin, string[]="")**

    Повертає значення властивості, коли передається ім'я; заповнює аргумент
    рядковий аргумент, коли передається значення. Рядок імені може бути
    може бути як запакованим, так і не запакованим рядком. Якщо властивість не існує
    не існує, функція повертає нуль.

**setproperty(id=0, const name[]="", value=cellmin, const string[]="")**

    Додайте нову властивість або змініть існуючу.

**deleteproperty(id=0, const name[]="", value=cellmin)**

    Повертає значення властивості і згодом видаляє його. Якщо властивість
    не існує, функція повертає нуль.

**existproperty(id=0, const name[]="", value=cellmin)**

    Повертає true, якщо властивість існує, і false в іншому випадку.

### - Функції консолі

Для тестування функції консолі, які зчитують введений користувачем рядок і виводять його у прокручуваному вікні або на екрані терміналу, часто
виводять рядки у вікно з прокруткою або на стандартний дисплей терміналу, часто бувають
зручними. Не всі типи терміналів та реалізації можуть реалізовувати усі
функції - особливо функції очищення екрана, встановлення кольорів переднього і
кольору переднього і заднього планів та керування положенням курсору, потребують розширеного керування терміналом.

**getchar(echo=true)**

    Прочитати один символ з клавіатури і повернути його. Функція може
    опціонально повторювати символ у вікні консолі.

**getstring(string[], size=sizeof string, bool**

    pack=false): Зчитати рядок з клавіатури. Функція getstring
    припиняє читання, коли буде натиснуто клавішу enter або досягнуто максимальної
    досягається максимальна довжина. Максимальна довжина вимірюється у комірках (не символах)
    і включає завершальний нульовий символ. Функція може читати
    як упаковані, так і неупаковані рядки; при читанні упакованого рядка функція
    може прочитати більше символів, ніж задано параметром size,
    оскільки кожна комірка містить декілька символів. Значенням, що повертається, є
    кількість прочитаних символів, за винятком завершального нульового символу.

**getvalue(base=10, end=' r', ...)**

    Зчитати значення (знакове число) з клавіатури. Функція getvalue
    дозволяє зчитувати в числовому радіусі від 2 до 36 (параметр base
    параметр) з десятковим радіксом за замовчуванням.

    За замовчуванням введення закінчується, коли користувач натискає клавішу введення, але
    можна вибрати одну або декілька різних клавіш (параметр end і
    наступний). У списку клавіш завершення введення додатне число (наприклад
    '\r') відображає клавішу і завершує введення, а від'ємне число
    завершує введення без відображення клавіші завершення.

**print(const string[], foreground=-1, background=-1)**

    Виводить на консоль простий рядок. Кольори переднього і заднього планів
    можна встановити за бажанням (але зауважте, що термінал або хост-програма
    програма може не підтримувати кольори). Список кольорів наведено у розділі setattr нижче.
    кольорів.

**printf(const format[], ...)**

    Виводить рядок з вбудованими кодами:

    %b вивести число на цій позиції в двійковому радіксі

    %c символ у цій позиції

    %d вивести число у цій позиції у десятковому форматі

    %f вивести число з плаваючою комою у цій позиції (припускаючи підтримку плаваючої
    з плаваючою комою)

    %q вивести число з фіксованою комою у цій позиції (якщо підтримується фіксована кома
    присутня підтримка фіксованої крапки)

    %r виводить або число з плаваючою комою, або число з фіксованою комою у цій позиції
    позиції, залежно від того, що доступно; якщо присутня підтримка як плаваючої, так і
    фіксованої точки, %r еквівалентний %f (тобто друкує
    число з плаваючою комою)

    %s виводить рядок символів у цій позиції

    %x вивести число у цій позиції у шістнадцятковому форматі з радіусом

    Функція printf працює подібно до функції printf мови C.

**clrscr()**

    Очищає консоль і встановлює курсор у верхньому лівому куті.

**clreol()**.

    Очищає рядок, на якому знаходиться курсор, від позиції курсору
    до правого краю консолі. Ця функція не переміщує
    курсор.

**gotoxy(x=1, y=1)**

    Встановлює положення курсору на консолі.
    Верхній лівий кут знаходиться на (1,1).

**setattr(foreground=-1, background=-1)**

    Встановлює кольори переднього та заднього плану для тексту, написаного на консолі
    консолі. Якщо один з двох параметрів має від'ємне значення (або відсутній), то
    відповідний параметр кольору не буде змінено. Значення кольору має бути
    бути значенням від нуля до семи, відповідно до ANSI Escape-послідовностей, ISO 6429.

    Наперед визначені константи для кольорів: чорний (0), червоний (1),
    зелений (2), жовтий (3), синій (4), пурпурний (5), блакитний (6) та білий (7).

### - Функції дати/часу

Функції отримання та встановлення поточної дати та часу, а також мілісекундного
таймер "події" з мілісекундною роздільною здатністю описано у примітці до програми "Бібліотека функцій часу", яку можна завантажити окремо.
Бібліотека функцій часу", яку можна завантажити окремо.

### - Введення/виведення файлів

Функції для роботи з текстовими та двійковими файлами, з прямою підтримкою текстових файлів у кодуванні UTF-8
файлів у кодуванні UTF-8, описано у примітці до програми "Бібліотека підтримки файлового вводу/виводу"
яку можна отримати окремо.

### - Арифметика з фіксованою комою

Модуль десяткової арифметики з фіксованою комою для пішака описано у прикладній записці під назвою "Бібліотека підтримки арифметики з фіксованою комою".
"Бібліотека підтримки числення з фіксованою комою", яка доступна
окремо.

### - Арифметика з плаваючою комою

Модуль арифметики з плаваючою комою для пішака описано у додатку
"Бібліотека підтримки обчислень з плаваючою комою", яка доступна окремо.

### - Маніпуляції з рядками

Загальний набір функцій маніпулювання рядками, які працюють як з упакованими, так і з
розпакованими рядками, описано у примітці до програми під назвою "Бібліотека маніпулювання рядками", яка
"Бібліотека маніпулювання рядками", яку можна отримати окремо.

### - інтерфейс виклику DLL

Версія абстрактної машини, яка зібрана у вигляді бібліотеки динамічних посилань
для Microsoft Windows має функцію загального призначення для виклику функції з
будь-якої DLL у пам'яті. Дві допоміжні функції завантажують DLL з диска у
і вивантажують її з пам'яті. Функції налаштовано таким чином, щоб можна було
запускати один і той самий скомпільований скрипт як у 16-бітній, так і у 32-бітній версіях Microsoft Windows.

Всі рядкові параметри можуть бути як в упакованому, так і в розпакованому вигляді.

**calldll(const dllname[], const function[], const typestr[], ...)**

    Параметр dllname - це ім'я модуля DLL, зазвичай це
    збігається з назвою файлу. Якщо DLL не вдасться знайти, calldll спробує ще раз
    після додавання "16" або "32" до імені файлу, залежно від того, чи
    ви використовуєте 16-бітну або 32-бітну версію абстрактної машини. Наприклад
    Наприклад, якщо ви задасте dllname як "USER", calldll з'єднається з користувачем USER у
    16-бітній версії абстрактної машини і до USER32 у 32-бітній
    версії.

    Параметр функції - це ім'я функції в DLL. У
    16-бітній версії це ім'я не залежить від регістру, але у 32-бітній версії
    Microsoft Windows імена експортованих функцій є чутливими до регістру.
    У 32-бітній версії абстрактної машини, якщо функцію не вдається
    знайти, calldll додає до імені велику літеру "A" і повторює спробу

    -багато функцій у 32-розрядній Windows існують у двох різновидах: ANSI та
    "Wide", і ці функції мають суфікс "A" або "W" відповідно.
    Відповідно, ці функції позначаються суфіксом "A" або "W". Отже, якщо функція має суфікс "MessageBox", то calldll викличе MessageBox
    у 16-бітній версії Windows і MessageBoxA у 32-бітній версії.
    версії.

    Рядковий параметр typestr вказує на кількість аргументів, які
    функція (у DLL) приймає, та їхні типи. Для кожного
    аргументу ви додаєте одну літеру до рядка typestr:

    h "хендл" Windows (HWND, HDC, HPALETTE, HMEM тощо)

    i ціле число з "власним розміром" (16-бітним або 32-бітним, залежно від
    "розрядності" абстрактної машини).

    l 32-бітне ціле число

    p упакований рядок

    s розпакований рядок

    w 16-бітне ціле число без знаку

    Якщо літера у нижньому регістрі, відповідний параметр передається
    "за значенням"; якщо літера у верхньому регістрі, вона передається "за посиланням". Різниця
    між упакованими та неупакованими рядками має значення лише тоді, коли
    параметр передається за посиланням.

**loaddll(const dllname[])**

    Завантажує вказану DLL у пам'ять (або збільшує лічильник її використання
    якщо вона вже була завантажена). Ім'я у параметрі dllname може містити
    повний шлях. Якщо шлях не вказано, Microsoft Windows шукає DLL у своїх
    системних каталогах шукає бібліотеку DLL. Подібно до функції calldll, ця функція

    додає "16" або "32" до імені DLL, якщо DLL не вдається
    знайти, а потім повторює спробу.

**freedll(const dllname[])**

    Зменшує лічильник використання DLL і, якщо лічильник дорівнює нулю,
    видаляє DLL з пам'яті. Ім'я у параметрі dllname може
    може містити повний шлях до бібліотеки, але інформація про шлях ігнорується. Подібно до функції
    функція calldll, ця функція додає "16" або "32" до імені DLL
    якщо DLL не вдається знайти, а потім повторює спробу.

**iswin32()**

    Повертає true, якщо абстрактна машина є 32-розрядною (працює у
    32-розрядної версії Microsoft Windows); повертає false, якщо абстрактна
    є 16-розрядною версією (працює або у Windows 3.1x, або у
    будь-якій пізнішій версії Microsoft Windows).

---

`amx_Exec: див. "Посібник реалізатора"`.

---

[Повернутися до змісту](00-Contents.md)


